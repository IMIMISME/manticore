{%block imports %}
import unittest
from os.path import dirname, abspath, join
from manticore.platforms import wasm
from manticore.core import state
from manticore.core.smtlib import Operators, ConstraintSet
from manticore.wasm.types import I32, F32, I64, F64
{% endblock %}

{% for module in modules %}
class WASMTest_{{ module.name }}(unittest.TestCase):
    _multiprocess_can_split_ = True
    filename = join(dirname(abspath(__file__)), "{{ module.filename }}")

{% for test in module.tests %}
<<<<<<< HEAD
    def test_{{ test.line }}(self):
=======
    def test_{{ test.dedup_name }}(self):
>>>>>>> cd86e6065b8eaebdaa7e3aeb5beb4f598bb4b3b3
        constraints = ConstraintSet()
        world = wasm.WASMWorld(self.filename)

        world.instantiate({})
        {% if test.args | length > 0 %}
        argv=[{{ test.args }}]
        {% else %}
        argv=[]
        {% endif %}
        world.invoke(name="{{ test.func }}", argv=argv)
        self.assertEqual(world.exec_for_test("{{test.func}}"), [{{ test.rets }}])
{% endfor %}
{% endfor %}

if __name__ == "__main__":
    unittest.main()
